{% extends 'base.html.twig' %}

{% block title %}detail salle {{ nomsalle }} 
{% endblock %}


{% block username %}Chargé de mission
{% endblock %}

{% block navlink %}
        <li>
            <a class="nav-link" href="/charge-de-mission/tableau-de-bord">Tableau de bord</a>
        </li>
        <li>
            <a class="nav-link" href="/charge-de-mission/liste-salles">Salles</a>
        </li>
        <li>
            <a class="nav-link" href="/charge-de-mission/plan-experimentation">Plan d'expérimentation</a>
        </li>
{% endblock %}

{% block appcontent %}
<div class="app-content tableau-de-bord details-salle">
        <div class="title">
            <a class="return-arrow" href="../../liste-salles">
                <svg xmlns="http://www.w3.org/2000/svg" width="47" height="40" viewBox="0 0 47 40" fill="none">
                    <path d="M9.63677 21.6039H6.64587L8.74729 23.7322L20.8538 35.9933C21.151 36.2943 21.3207 36.706 21.3207 37.1385C21.3207 37.571 21.151 37.9826 20.8538 38.2836C20.5572 38.5841 20.1584 38.7499 19.746 38.7499C19.3336 38.7499 18.9347 38.5841 18.6381 38.2836L1.71895 21.145L1.71742 21.1435C1.57029 20.9949 1.4527 20.8176 1.37219 20.6212C1.29166 20.4247 1.25 20.2135 1.25 19.9999C1.25 19.7862 1.29166 19.575 1.37219 19.3786C1.45271 19.1821 1.57029 19.0048 1.71742 18.8563L1.71894 18.8547L18.6381 1.71612L17.7538 0.843108L18.6381 1.71612C18.7851 1.56724 18.9587 1.45001 19.1486 1.37033C19.3385 1.29066 19.5414 1.24987 19.746 1.24987C19.9505 1.24987 20.1535 1.29066 20.3433 1.37033C20.5332 1.45001 20.7069 1.56724 20.8538 1.71612L21.7412 0.840088L20.8538 1.71612C21.0008 1.86504 21.1183 2.0427 21.1987 2.23937C21.2792 2.43606 21.3207 2.64743 21.3207 2.86126C21.3207 3.07509 21.2792 3.28646 21.1987 3.48316C21.1183 3.67982 21.0008 3.85748 20.8538 4.00639L8.74746 16.2626L6.64506 18.3911H9.63677H44.1801C44.5913 18.3911 44.9888 18.5563 45.2845 18.8559C45.5807 19.1559 45.75 19.5663 45.75 19.9975C45.75 20.4287 45.5807 20.8391 45.2845 21.1391C44.9888 21.4386 44.5913 21.6039 44.1801 21.6039H9.63677Z" fill="white" stroke="white" stroke-width="2.5"/>
                </svg>
            </a>
            <h3>{{ nomsalle }}</h3>
        </div>

        
        <div class="infos-sa">
        {% if etat_sa != null %}
        {# Carte d'information sur le sa #}
            <div class="">
            {# partie gauche de la carte #}
                <h4>{{ etat_sa.nom_sa }}</h4>
                <div class="sa-etat">
                    <h5>État : <span>{{ etat_sa.etat_sa.value == 0 ? 'Éteint' : (etat_sa.etat_sa.value == 1 ? 'En marche' : 'Défaillance') }}</span></h5>
                    <div class="voyant {{ etat_sa.etat_sa.value == 0 ? 'voyant-rouge' : (etat_sa.etat_sa.value == 1 ? 'voyant-vert' : 'voyant-orange') }}"></div>
                </div>
            </div>
            {# image de droite de la carte #}
            <svg xmlns="http://www.w3.org/2000/svg" width="85" height="61" viewBox="0 0 85 61" fill="none">
                <path fill-rule="evenodd" clip-rule="evenodd" d="M42.1667 18.3234C44.8806 18.3219 47.5075 19.2803 49.5829 21.029C51.6583 22.7777 53.0484 25.204 53.5073 27.8789C53.9662 30.5537 53.4643 33.3046 52.0904 35.6451C50.7165 37.9855 48.5592 39.7647 46 40.6679V60.4862H38.3333V40.6679C35.7759 39.7626 33.6207 37.9827 32.2484 35.6425C30.8761 33.3023 30.3751 30.5524 30.8337 27.8785C31.2923 25.2047 32.6812 22.779 34.7549 21.0299C36.8286 19.2807 39.4538 18.3208 42.1667 18.3195V18.3234ZM42.1667 25.99C43.1833 25.99 44.1583 26.3939 44.8772 27.1128C45.5961 27.8317 46 28.8067 46 29.8234C46 30.84 45.5961 31.815 44.8772 32.5339C44.1583 33.2528 43.1833 33.6567 42.1667 33.6567C41.15 33.6567 40.175 33.2528 39.4561 32.5339C38.7372 31.815 38.3333 30.84 38.3333 29.8234C38.3333 28.8067 38.7372 27.8317 39.4561 27.1128C40.175 26.3939 41.15 25.99 42.1667 25.99Z" fill="white"/>
                <path id="svg2" d="M23.1917 10.8483C20.6963 13.3374 18.7175 16.2952 17.3689 19.5516C16.0203 22.8079 15.3285 26.2987 15.3334 29.8233C15.3334 38.1685 19.1437 45.6243 25.1237 50.5463L30.5786 45.0876C28.2219 43.3018 26.3112 40.9941 24.9963 38.3457C23.6814 35.6973 22.9981 32.7802 23.0001 29.8233C23.0001 24.5333 25.1467 19.7416 28.6121 16.2725L23.1917 10.8483ZM55.7214 16.2648C57.5041 18.0435 58.9176 20.1571 59.8807 22.4839C60.8438 24.8108 61.3375 27.305 61.3334 29.8233C61.3334 36.0563 58.3587 41.5916 53.7549 45.0915L59.2097 50.5502C62.2744 48.0349 64.7424 44.8705 66.4355 41.2855C68.1286 37.7004 69.0045 33.7842 69.0001 29.8195C69.0049 26.2949 68.3132 22.8041 66.9646 19.5477C65.616 16.2914 63.6371 13.3336 61.1417 10.8445L55.7214 16.2648Z" fill="white"/>
                <path id="svg3" d="M3.46334e-05 29.8233C-0.00707467 24.2838 1.08039 18.7974 3.19997 13.6794C5.31954 8.56134 8.42945 3.91253 12.351 0L17.7714 5.42417C14.5625 8.62474 12.0179 12.428 10.2838 16.6152C8.54971 20.8025 7.6603 25.2912 7.6667 29.8233C7.6608 34.3548 8.55046 38.8428 10.2846 43.0294C12.0187 47.2159 14.563 51.0185 17.7714 54.2187L12.351 59.639C8.42968 55.7279 5.31986 51.0804 3.20026 45.9637C1.08067 40.8469 -0.00690413 35.3617 3.46334e-05 29.8233ZM71.9824 59.6352C75.9034 55.7246 79.0131 51.0778 81.1327 45.9617C83.2523 40.8456 84.34 35.3611 84.3334 29.8233C84.3334 18.1777 79.6145 7.636 71.9824 0.00766611L66.562 5.428C69.7704 8.62812 72.3147 12.4307 74.0488 16.6173C75.7829 20.8039 76.6726 25.2918 76.6667 29.8233C76.6726 34.3548 75.7829 38.8428 74.0488 43.0294C72.3147 47.2159 69.7704 51.0185 66.562 54.2187L71.9824 59.6352Z" fill="white"/>
            </svg>
        {% endif %}
        </div>

    {# -------------------------------------------------- #}


    {# CONTAINER (données générales) #}
    <div class="container widget-dg">
        <div class="title">
            <h4>Données instantanées</h4>
            <p>{{ elapsed != null ? 'il y a ' ~ elapsed : 'Aucunes données reçues pour le moment...' }}</p>
        </div>
        <div class="donnees donnees-wrap">
            <div class="donnee">
                <svg xmlns="http://www.w3.org/2000/svg" width="77" height="77" viewBox="0 0 77 77" fill="none">
                    <path d="M38.5 70.5833C31.1743 70.5833 25.0646 68.0701 20.1708 63.0437C15.277 58.0173 12.8312 51.7611 12.8333 44.275C12.8333 40.9597 13.5819 37.6444 15.0792 34.3291C16.5764 31.0139 18.4479 27.8323 20.6937 24.7844C22.9396 21.7364 25.3726 18.8757 27.9927 16.2021C30.6128 13.5285 33.0458 11.2024 35.2917 9.22394C35.7194 8.79616 36.2146 8.48923 36.7771 8.30315C37.3396 8.11706 37.9139 8.02295 38.5 8.02081C39.0882 8.02081 39.6625 8.11492 40.2229 8.30315C40.7833 8.49137 41.2784 8.7983 41.7083 9.22394C43.9542 11.2024 46.3871 13.5285 49.0073 16.2021C51.6274 18.8757 54.0604 21.7364 56.3062 24.7844C58.5521 27.8323 60.4236 31.0139 61.9208 34.3291C63.418 37.6444 64.1667 40.9597 64.1667 44.275C64.1667 51.7611 61.7198 58.0173 56.826 63.0437C51.9322 68.0701 45.8235 70.5833 38.5 70.5833ZM46.5208 57.75C47.8576 57.75 48.9945 57.2816 49.9313 56.3447C50.8681 55.4079 51.3355 54.2721 51.3333 52.9375C51.3333 51.6007 50.8649 50.4639 49.9281 49.527C48.9912 48.5902 47.8555 48.1228 46.5208 48.125C45.184 48.125 44.0472 48.5934 43.1104 49.5302C42.1735 50.4671 41.7062 51.6028 41.7083 52.9375C41.7083 54.2743 42.1767 55.4111 43.1136 56.3479C44.0504 57.2848 45.1862 57.7521 46.5208 57.75ZM28.0729 55.3437C28.7146 55.9854 29.4632 56.3062 30.3187 56.3062C31.1743 56.3062 31.9229 55.9854 32.5646 55.3437L48.9271 38.9812C49.5687 38.3396 49.8896 37.591 49.8896 36.7354C49.8896 35.8798 49.5687 35.1312 48.9271 34.4896C48.2854 33.8479 47.5229 33.5271 46.6395 33.5271C45.7562 33.5271 44.9947 33.8479 44.3552 34.4896L28.0729 50.7719C27.4312 51.4135 27.1104 52.176 27.1104 53.0594C27.1104 53.9428 27.4312 54.7042 28.0729 55.3437ZM30.4792 41.7083C31.816 41.7083 32.9528 41.2399 33.8896 40.3031C34.8265 39.3662 35.2938 38.2305 35.2917 36.8958C35.2917 35.559 34.8232 34.4222 33.8864 33.4854C32.9496 32.5485 31.8138 32.0812 30.4792 32.0833C29.1424 32.0833 28.0055 32.5517 27.0687 33.4886C26.1319 34.4254 25.6645 35.5611 25.6667 36.8958C25.6667 38.2326 26.1351 39.3694 27.0719 40.3063C28.0087 41.2431 29.1445 41.7105 30.4792 41.7083Z" fill="#BABABA"/>
                </svg>
                {% if dernieres_donnees.hum < 40 and  dernieres_donnees.hum > 70 %}
                    <h4 style="color: orange">
                        {{ dernieres_donnees.hum | default('--') }}%
                    </h4>
                {% elseif dernieres_donnees.hum == 0 or dernieres_donnees.hum == 100 %}
                    <h4 style="color: red">
                        {{ dernieres_donnees.hum | default('--') }}%
                    </h4>
                {% else %}
                    <h4>
                        {{ dernieres_donnees.hum | default('--') }}%
                    </h4>
                {% endif %}
                <p>Humidité</p>
            </div>

            <div class="donnee">
                <svg xmlns="http://www.w3.org/2000/svg" width="77" height="77" viewBox="0 0 77 77" fill="none">
                    <path d="M48.125 41.7084V16.0417C48.125 13.489 47.1109 11.0408 45.3059 9.23578C43.5008 7.43075 41.0527 6.41669 38.5 6.41669C35.9473 6.41669 33.4991 7.43075 31.6941 9.23578C29.889 11.0408 28.875 13.489 28.875 16.0417V41.7084C26.1815 43.7285 24.1919 46.5449 23.188 49.7586C22.1841 52.9723 22.2168 56.4204 23.2815 59.6145C24.3462 62.8086 26.3889 65.5867 29.1203 67.5554C31.8516 69.524 35.1331 70.5834 38.5 70.5834C41.8668 70.5834 45.1484 69.524 47.8797 67.5554C50.611 65.5867 52.6537 62.8086 53.7184 59.6145C54.7831 56.4204 54.8159 52.9723 53.812 49.7586C52.8081 46.5449 50.8185 43.7285 48.125 41.7084ZM38.5 12.8334C39.3509 12.8334 40.1669 13.1714 40.7686 13.7731C41.3703 14.3747 41.7083 15.1908 41.7083 16.0417V25.6667H35.2916V16.0417C35.2916 15.1908 35.6297 14.3747 36.2313 13.7731C36.833 13.1714 37.6491 12.8334 38.5 12.8334Z" fill="#BABABA"/>
                </svg>
                {% if dernieres_donnees.temp < intervalleTempSaison[0] or  dernieres_donnees.temp > intervalleTempSaison[3] %}
                    <h4 style="color: red">
                        {{ dernieres_donnees.temp | default('--') }}°C
                    </h4>
                {% elseif dernieres_donnees.temp < intervalleTempSaison[1] or dernieres_donnees.temp > intervalleTempSaison[2] %}
                    <h4 style="color: orange">
                        {{ dernieres_donnees.temp | default('--') }}°C
                    </h4>
                {% else %}
                    <h4>
                        {{ dernieres_donnees.temp | default('--') }}°C
                    </h4>
                {% endif %}

                <p>Température</p>
            </div>

            <div class="donnee">
                <svg xmlns="http://www.w3.org/2000/svg" width="77" height="77" viewBox="0 0 77 77" fill="none">
                    <path d="M42.35 26.95C51.8402 26.95 57.2225 33.0099 58.0041 40.3249H58.2428C64.3489 40.3249 69.3 45.0874 69.3 50.9625C69.3 56.8376 64.3489 61.6 58.2428 61.6H26.4572C20.3511 61.6 15.4 56.8376 15.4 50.9625C15.4 45.0874 20.3511 40.3249 26.4572 40.3249H26.6959C27.4851 32.9599 32.8597 26.95 42.35 26.95ZM32.3092 15.4C37.9148 15.4 42.8043 18.5878 45.2182 23.2733C44.2666 23.1566 43.3087 23.0987 42.35 23.1C33.1485 23.1 26.4418 28.132 24.0471 35.7511L23.8084 36.575L23.6313 37.295L22.996 37.4105C20.6711 37.884 18.4994 38.9257 16.6749 40.4426C14.8503 41.9595 13.4296 43.9044 12.5394 46.1038C10.7053 44.9863 9.27543 43.313 8.45758 41.3272C7.63972 39.3413 7.47655 37.1463 7.99179 35.0613C8.50702 32.9763 9.6738 31.11 11.3225 29.7337C12.9712 28.3573 15.016 27.5427 17.1594 27.4082L18.0141 27.3889C18.6078 24.0291 20.3661 20.9859 22.9803 18.7934C25.5944 16.601 28.8974 15.3996 32.3092 15.4Z" fill="#BABABA"/>
                </svg>
                {% if dernieres_donnees.co2 > 1500 or dernieres_donnees.co2 < 400 %}
                    <h4 style="color: red">
                        {{ dernieres_donnees.co2 | default('---') }}ppm
                    </h4>
                {% elseif dernieres_donnees.co2 >= 1000 %}
                    <h4 style="color: orange">
                        {{ dernieres_donnees.co2 | default('---') }}ppm
                    </h4>
                {% else %}
                    <h4>
                        {{ dernieres_donnees.co2 | default('---') }}ppm
                    </h4>
                {% endif %}
                <p>Taux de carbone</p>
            </div>
        </div>
    </div>

    {# -------------------------------------------------- #}

    <div class="pages-boutons">
            <a href="../historique/{{ nomsalle }}" class="page-bouton">
                Historique
                <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 32 32" fill="none">
                    <g clip-path="url(#clip0_279_1730)">
                        <path d="M7.51467 24.4853C9.47793 26.4485 12.0612 27.6703 14.8244 27.9423C17.5875 28.2143 20.3595 27.5197 22.6679 25.977C24.9763 24.4342 26.6783 22.1387 27.4838 19.4816C28.2894 16.8245 28.1486 13.9703 27.0856 11.4054C26.0225 8.84052 24.1029 6.7236 21.6539 5.41544C19.2049 4.10727 16.3781 3.68881 13.6551 4.23136C10.9321 4.77391 8.48155 6.2439 6.72098 8.39083C4.96041 10.5378 3.99879 13.2288 4 16.0052V18.6666" stroke="white" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"/>
                        <path d="M1.33337 15.9998L4.00004 18.6665L6.66671 15.9998M14.6667 10.6665V17.3332H21.3334" stroke="white" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"/>
                    </g>
                    <defs>
                        <clipPath id="clip0_279_1730">
                            <rect width="32" height="32" fill="white"/>
                        </clipPath>
                    </defs>
                </svg>
            </a>

        <a href="../diagnostic/{{ nomsalle }}" class="page-bouton">
            Diagnostic
            <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 32 32" fill="none">
                <path d="M26.0013 12.9981C26.0013 15.8664 25.07 18.516 23.5011 20.6657L31.414 28.5833C32.1953 29.3644 32.1953 30.633 31.414 31.4141C30.6327 32.1953 29.3639 32.1953 28.5826 31.4141L20.6698 23.4966C18.5197 25.0713 15.8695 25.9962 13.0006 25.9962C5.81903 25.9962 0 20.1783 0 12.9981C0 5.8179 5.81903 0 13.0006 0C20.1822 0 26.0013 5.8179 26.0013 12.9981ZM13.0006 21.9968C14.1826 21.9968 15.353 21.764 16.445 21.3118C17.5369 20.8596 18.5291 20.1967 19.3649 19.3611C20.2007 18.5255 20.8636 17.5335 21.316 16.4417C21.7683 15.35 22.0011 14.1798 22.0011 12.9981C22.0011 11.8164 21.7683 10.6462 21.316 9.55445C20.8636 8.46268 20.2007 7.47067 19.3649 6.63507C18.5291 5.79946 17.5369 5.13662 16.445 4.6844C15.353 4.23217 14.1826 3.99941 13.0006 3.99941C11.8187 3.99941 10.6483 4.23217 9.55632 4.6844C8.46433 5.13662 7.47213 5.79946 6.63636 6.63507C5.80059 7.47067 5.13763 8.46268 4.68531 9.55445C4.233 10.6462 4.0002 11.8164 4.0002 12.9981C4.0002 14.1798 4.233 15.35 4.68531 16.4417C5.13763 17.5335 5.80059 18.5255 6.63636 19.3611C7.47213 20.1967 8.46433 20.8596 9.55632 21.3118C10.6483 21.764 11.8187 21.9968 13.0006 21.9968Z" fill="white"/>
            </svg>
        </a>

            <a href="../archives/{{ nomsalle }}" class="page-bouton">
                Archives
                <svg xmlns="http://www.w3.org/2000/svg" width="36" height="29" viewBox="0 0 36 29" fill="none">
                    <path d="M13.536 6.27677e-09C14.0208 -2.70751e-05 14.5005 0.0875786 14.9466 0.257563C15.3926 0.427548 15.7957 0.676409 16.1316 0.989222L16.3476 1.20994L18.864 4.02778H32.4C33.3082 4.02752 34.183 4.33454 34.849 4.8873C35.515 5.44006 35.9229 6.19769 35.991 7.00833L36 7.25V25.7778C36.0003 26.5907 35.6573 27.3737 35.0397 27.9698C34.4221 28.5659 33.5757 28.931 32.67 28.9919L32.4 29H3.6C2.69176 29.0003 1.81698 28.6932 1.15101 28.1405C0.485047 27.5877 0.0771182 26.8301 0.00900039 26.0194L1.80482e-07 25.7778V3.22222C-0.000287243 2.40929 0.342732 1.62631 0.960295 1.03023C1.57786 0.434147 2.42432 0.0690254 3.33 0.00805575L3.6 6.27677e-09H13.536ZM32.4 12.8889H3.6V25.7778H32.4V12.8889ZM13.536 3.22222H3.6V9.66667H32.4V7.25H18.864C18.3792 7.25003 17.8995 7.16242 17.4534 6.99244C17.0074 6.82245 16.6043 6.57359 16.2684 6.26078L16.0524 6.04006L13.536 3.22222Z" fill="white"/>
                </svg>
            </a>
    </div>


        
</div>
{% endblock %}

{% block javascripts %}
<script src="{{ asset('js/iconConnexion.js') }}"></script>
{% endblock %}
